@{
    ViewData["Title"] = "aNerMe|Add Product";
}
@model Administrator
<partial name="_BusinessHeaderNavPartial" />

<div class="business-body">
    <div class="business-side-menu">
        <partial name="_BusinessSideMenuNavPartial"/>
    </div>
    <div class="business-main-body">
        <div class="container">
            <h1>Contact Us Page Manager: @Model.company.MenuItem.Title</h1>
            <p>Fill in the details about your store below. For days you are closed leave them open and close times blank.</p>
            <div class="cards">
                <div class="contact-us-card">
                    <div id="open-modal" class="image-box">
                        Click here to upload an image of your store
                    </div>
                    <input type="hidden" id="menu-item-id" asp-for="@Model.company.MenuItem.MenuItemID">
                    <input type="text" id="store-name" class="store-name" placeholder="Store/City Name" asp-for="@Model.company.MenuItem.ContactUsPage.StoreName">
                    <input type="text" id="street-address" placeholder="Street Address" asp-for="@Model.company.MenuItem.ContactUsPage.Address.StreetAddress.StreetAddressName">
                    <div class="city-state-zip">
                        <input type="text" id="city" placeholder="City" asp-for="@Model.company.MenuItem.ContactUsPage.Address.City.CityName">
                        <input type="text" id="state" placeholder="State" asp-for="@Model.company.MenuItem.ContactUsPage.Address.State.StateName">
                        <input type="number" id="zip" placeholder="Zip" asp-for="@Model.company.MenuItem.ContactUsPage.Address.Zip">
                    </div>
                    <input type="text" class="phone-number" id="phone-number" placeholder="Phone Number" asp-for="@Model.company.MenuItem.ContactUsPage.PhoneNumber">
                </div>
                <div class="contact-us-card">
                    <h2>Store Hours</h2>
                    <div class="day">
                        <span>Sunday</span>
                        <div class="open-close">
                            <input type="time" class="open" id="sunday-open" asp-for="@Model.company.MenuItem.ContactUsPage.SundayOpen">
                            <input type="time" class="close" id="sunday-close" asp-for="@Model.company.MenuItem.ContactUsPage.SundayClose">
                        </div>
                    </div>
                    <div class="day">
                        <span>Monday</span>
                        <div class="open-close">
                            <input type="time" class="open" id="monday-open" asp-for="@Model.company.MenuItem.ContactUsPage.MondayOpen">
                            <input type="time" class="close" id="monday-close" asp-for="@Model.company.MenuItem.ContactUsPage.MondayClose">
                        </div>
                    </div>
                    <div class="day">
                        <span>Tuesday</span>
                        <div class="open-close">
                            <input type="time" class="open" id="tuesday-open" asp-for="@Model.company.MenuItem.ContactUsPage.TuesdayOpen">
                            <input type="time" class="close" id="tuesday-close" asp-for="@Model.company.MenuItem.ContactUsPage.TuesdayClose">
                        </div>
                    </div>
                    <div class="day">
                        <span>Wednesday</span>
                        <div class="open-close">
                            <input type="time" class="open" id="wednesday-open" asp-for="@Model.company.MenuItem.ContactUsPage.WednesdayOpen">
                            <input type="time" class="close" id="wednesday-close" asp-for="@Model.company.MenuItem.ContactUsPage.WednesdayClose">
                        </div>
                    </div>
                    <div class="day">
                        <span>Thursday</span>
                        <div class="open-close">
                            <input type="time" class="open" id="thursday-open" asp-for="@Model.company.MenuItem.ContactUsPage.ThursdayOpen">
                            <input type="time" class="close" id="thursday-close" asp-for="@Model.company.MenuItem.ContactUsPage.ThursdayClose">
                        </div>
                    </div>
                    <div class="day">
                        <span>Friday</span>
                        <div class="open-close">
                            <input type="time" class="open" id="friday-open" asp-for="@Model.company.MenuItem.ContactUsPage.FridayOpen">
                            <input type="time" class="close"id="friday-close" asp-for="@Model.company.MenuItem.ContactUsPage.FridayClose">
                        </div>
                    </div>
                    <div class="day">
                        <span>Saturday</span>
                        <div class="open-close">
                            <input type="time" class="open" id="saturday-open" asp-for="@Model.company.MenuItem.ContactUsPage.SaturdayOpen">
                            <input type="time" class="close" id="saturday-close" asp-for="@Model.company.MenuItem.ContactUsPage.SaturdayClose">
                        </div>
                    </div>
                </div>
                <div class="contact-us-card">
                    <div class="store-map">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3018.801513217861!2d-115.765275884285!3d40.83232323818215!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80a60733d3587aad%3A0x1d547f767f7f98c9!2sCarlin%20Trend%20Mining%20Supply%20%26%20Services!5e0!3m2!1sen!2sus!4v1619714139118!5m2!1sen!2sus" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                    </div>
                    <h2>Delivery Menthods</h2>
                    <div class="delivery-options">
                        @for(int i = 0; i < Model.company.DeliveryMethods.Count(); i++)
                        {
                            bool found = false;
                            if(Model.company.MenuItem.ContactUsPage != null)
                            {
                                if(Model.company.MenuItem.ContactUsPage.StoreDeliveryMethods != null)
                                {
                                    for(int x = 0; x < Model.company.MenuItem.ContactUsPage.StoreDeliveryMethods.Count(); x++)
                                    {
                                        if(Model.company.MenuItem.ContactUsPage.StoreDeliveryMethods[x].DeliveryMethodID == Model.company.DeliveryMethods[i].DeliveryMethodID)
                                        {
                                            found = true;
                                        }
                                    }
                                }
                            }
                            <div class="delivery-option">
                                @if(found)
                                {
                                    <input type="checkbox" checked class="delivery-method" value="@Model.company.DeliveryMethods[i].DeliveryMethodID">                                    
                                }
                                else
                                {
                                    <input type="checkbox" class="delivery-method" value="@Model.company.DeliveryMethods[i].DeliveryMethodID">                                    
                                }
                                <span>@Model.company.DeliveryMethods[i].DeliveryMethodName</span>
                            </div>
                        }
                    </div>
                </div>
            </div>
            <button class="btn btn-primary submit-page-changes" id="submit-page-changes">Submit Changes</button>
        </div>
    </div>
    <partial name="_BusinessPictureModal" />
</div>


<script>
    var dbSelectedImage = null;
    var companyImages = @Html.Raw(Json.Serialize(Model.company.Images));    
    document.getElementById('modal-images-grid').addEventListener('click', () => {
        if(imageSelectArr.length > 1){
            imageSelect(`image-${imageSelectArr[0]}`);
        }
    });
</script>
@if(Model.company.MenuItem.ContactUsPage != null)
{
    <script>
        dbSelectedImage = @Html.Raw(Json.Serialize(Model.company.MenuItem.ContactUsPage.ImageID));
    </script>
}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="~/js/imageLoaderDropZone.js" asp-append-version="true"></script>
<script src="~/js/imagePopupModal.js" asp-append-version="true"></script>
<script src="~/js/contactUsPageManager.js" asp-append-version="true"></script>
<script>
    document.getElementById('upload-image-btn').addEventListener('click', () => {
        if(imageSelectArr.length == 0){
            console.log(imageSelectArr);
            document.querySelector('.image-box').innerHTML = "Click here to upload an image of your store";
        }
        else{
            for(var x = 0; x < companyImages.length; x++){
                if(imageSelectArr[0] == companyImages[x].imageID){
                    document.querySelector('.image-box').innerHTML = `<img src="${companyImages[x].imagePath}" class="selected-image" id="selected-image-${companyImages[x].imageID}" alt="">`;
                    break;
                }
            }
        }
        overlay.dispatchEvent(new Event('click'));
    })
    if(dbSelectedImage != null){
        document.getElementById(`image-${dbSelectedImage}`).dispatchEvent(new Event('click'));
        document.getElementById('upload-image-btn').dispatchEvent(new Event('click'));
    }
</script>